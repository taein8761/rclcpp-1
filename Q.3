pub1_3.cpp
#include "rclcpp/rclcpp.hpp"
#include "geometry_msgs/msg/twist.hpp"
#include <termios.h>
#include <unistd.h>
#include <iostream>

class TeleopTurtle : public rclcpp::Node
{
public:
    TeleopTurtle() : Node("teleop_turtle")
    {
        // Publisher 생성
        publisher_ = this->create_publisher<geometry_msgs::msg::Twist>("/turtle1/cmd_vel", 10);

        // 타이머 설정: 0.1초마다 키 입력 처리
        timer_ = this->create_wall_timer(
            std::chrono::milliseconds(100),
            [this]() {
                char key = getKey();
                geometry_msgs::msg::Twist msg;

                // 키에 따라 Turtle 이동 제어
                switch (key)
                {
                    case 'f':  // 전진
                        msg.linear.x = 1.0;
                        msg.angular.z = 0.0;
                        break;
                    case 'b':  // 후진
                        msg.linear.x = -1.0;
                        msg.angular.z = 0.0;
                        break;
                    case 'l':  // 좌회전
                        msg.linear.x = 0.0;
                        msg.angular.z = 1.0;
                        break;
                    case 'r':  // 우회전
                        msg.linear.x = 0.0;
                        msg.angular.z = -1.0;
                        break;
                    default:
                        msg.linear.x = 0.0;
                        msg.angular.z = 0.0;
                        break;
                }

                // 메시지 발행
                publisher_->publish(msg);
            });
    }

private:
    // 키보드 입력을 받는 함수
    char getKey()
    {
        struct termios oldt, newt;
        char ch;
        tcgetattr(STDIN_FILENO, &oldt);
        newt = oldt;
        newt.c_lflag &= ~(ICANON | ECHO);  // 개별 키 입력 받기
        tcsetattr(STDIN_FILENO, TCSANOW, &newt);
        ch = getchar();
        tcsetattr(STDIN_FILENO, TCSANOW, &oldt);
        return ch;
    }

    rclcpp::Publisher<geometry_msgs::msg::Twist>::SharedPtr publisher_;
    rclcpp::TimerBase::SharedPtr timer_;
};

int main(int argc, char *argv[])
{
    rclcpp::init(argc, argv);  // ROS2 초기화
    rclcpp::spin(std::make_shared<TeleopTurtle>());  // TeleopTurtle 노드 실행
    rclcpp::shutdown();  // 종료
    return 0;
}

CMakeLists.txt
cmake_minimum_required(VERSION 3.16)
project(pub1_3)

# Default to C99
if(NOT CMAKE_C_STANDARD)
  set(CMAKE_C_STANDARD 99)
endif()

# Default to C++14
if(NOT CMAKE_CXX_STANDARD)
  set(CMAKE_CXX_STANDARD 14)
endif()

if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES "Clang")
  add_compile_options(-Wall -Wextra -Wpedantic)
endif()

# find dependencies
find_package(ament_cmake REQUIRED)
find_package(rclcpp REQUIRED)
find_package(geometry_msgs REQUIRED)  # geometry_msgs 의존성 추가

# 실행 파일 추가
add_executable(pub1_3 src/pub1_3.cpp)  # 실행 파일 이름 pub1_3으로 설정

# 타겟 링크
ament_target_dependencies(pub1_3 rclcpp geometry_msgs)  # geometry_msgs 의존성 추가

# 설치
install(TARGETS
  pub1_3  # 설치할 파일 이름 pub1_3으로 설정
  DESTINATION lib/${PROJECT_NAME})

ament_package()

